<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the downloadFile Shiny Module • periscope2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the downloadFile Shiny Module">
<meta property="og:description" content="periscope2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">periscope2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/announcement-module.html">Using the Announcement Shiny Module</a>
    </li>
    <li>
      <a href="../articles/applicationReset-module.html">Using the appReset Shiny Module</a>
    </li>
    <li>
      <a href="../articles/downloadFile-module.html">Using the downloadFile Shiny Module</a>
    </li>
    <li>
      <a href="../articles/downloadablePlot-module.html">Using the downloadablePlot Shiny Module</a>
    </li>
    <li>
      <a href="../articles/downloadableTable-module.html">Using the downloadableTable Shiny Module</a>
    </li>
    <li>
      <a href="../articles/logViewer-module.html">Using the logViewer Shiny Module</a>
    </li>
    <li>
      <a href="../articles/new-application.html">Creating a new framework-based application</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Aggregate-Genius/periscope2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the downloadFile Shiny Module</h1>
                        <h4 data-toc-skip class="author">Dr. Connie
Brett</h4>
            
            <h4 data-toc-skip class="date">2023-05-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Aggregate-Genius/periscope2/blob/HEAD/vignettes/downloadFile-module.Rmd" class="external-link"><code>vignettes/downloadFile-module.Rmd</code></a></small>
      <div class="hidden name"><code>downloadFile-module.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<div class="section level3">
<h3 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h3>
<p>This <em>Shiny Module</em> was created in order to provide a
consistent-looking and easy-to-use button that facilitates one or
multiple types of file downloads.</p>
</div>
<div class="section level3">
<h3 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h3>
<ul>
<li>Auto-adjusts the button image and styling for single or multiple
downloads</li>
<li>Ability to link different data sets to different file types if
desired</li>
<li>Incorporates tooltips and drop-downs automatically</li>
<li>Converts data to various download types.</li>
<li>Requires minimal code (see the Usage section for details)</li>
</ul>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="shiny-module-overview">Shiny Module Overview<a class="anchor" aria-label="anchor" href="#shiny-module-overview"></a>
</h3>
<p>Shiny modules consist of a pair of functions that modularize, or
package, a small piece of reusable functionality. The UI function is
called directly by the user to place the UI in the correct location (as
with other shiny UI objects). The module server function that is called
only once to set it up using the module name as a function inside the
server function (i.e. user-local session scope. The function first
arguments is string represents the module id (the same id used in module
UI function). Additional arguments can be supplied by the user based on
the specific shiny module that is called. There can be additional helper
functions that are a part of a shiny module.</p>
<p>The <strong>downloadFile</strong> Shiny Module is a part of the
<em>periscope2</em> package and consists of the following functions:</p>
<ul>
<li>
<strong>downloadFileButton</strong> - the UI function to place the
button in the application.</li>
<li>
<strong>downloadFile</strong> - the server function to be called
inside server_local.R.</li>
<li>
<strong>downloadFile_ValidateTypes</strong> - a helper function that
will check a given list of file types and warn the caller if the list
contains an invalid or unsupported type.</li>
<li>
<strong>downloadFile_AvailableTypes</strong> - a helper function
that will return a vector of supported file types.</li>
</ul>
</div>
<div class="section level3">
<h3 id="downloadfilebutton">downloadFileButton<a class="anchor" aria-label="anchor" href="#downloadfilebutton"></a>
</h3>
<p>The <strong>downloadFileButton</strong> function is called from the
ui.R (or equivalent) file in the location where the button should be
placed. This is similar to other UI element placement in shiny.</p>
<p>The downloadFileButton function takes the unique object ID for the UI
object as well as a list of file types the button will allow the user to
request and the tooltip text.</p>
<p>If only one type is given the button will be a single-download type
of button that starts the specified download when the button is pressed.
The button will look like:</p>
<center>
<img src="figures/downloadFile-1.jpg" width="50px">
</center>
<p>If more than one type is given there will be a dropdown choice given
to the user when the button is pressed and the download will start when
the choose one of the types. The dropdown choices will be in the order
given by the call to the function. The button and dropdown will look
like:</p>
<center>
<img src="figures/downloadFile-2.jpg" width="50px" align="top"><img src="figures/downloadFile-3.jpg" width="200px">
</center>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inside ui_body.R or ui_sidebar.R</span></span>
<span></span>
<span><span class="co">#single download type</span></span>
<span><span class="fu"><a href="../reference/downloadFileButton.html">downloadFileButton</a></span><span class="op">(</span><span class="st">"object_id1"</span>, </span>
<span>                   downloadtypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"csv"</span><span class="op">)</span>, </span>
<span>                   hovertext     <span class="op">=</span> <span class="st">"Button 1 Tooltip"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#multiple download types</span></span>
<span><span class="fu"><a href="../reference/downloadFileButton.html">downloadFileButton</a></span><span class="op">(</span><span class="st">"object_id2"</span>, </span>
<span>                   downloadtypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"csv"</span>, <span class="st">"tsv"</span><span class="op">)</span>, </span>
<span>                   hovertext     <span class="op">=</span> <span class="st">"Button 2 Tooltip"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downloadfile">downloadFile<a class="anchor" aria-label="anchor" href="#downloadfile"></a>
</h3>
<p>The <strong>downloadFile</strong> function is called directly. The
call consists of the following:</p>
<ul>
<li>the unique object ID that was provided to downloadFileButton when
creating the UI object</li>
<li>the logging logger to be used</li>
<li>the root of the downloaded file name to be used in the browser as a
character string or reactive expression that returns a character
string</li>
<li>a <strong>named list</strong> of functions that provide the data
(see below). It is important that the types of files to be downloaded
are matched to the correct data function in the list. The data functions
are unquoted function names. The functions will be called at the time
the user initiates a download <em>(see requirements below)</em>.</li>
<li>the aspect ratio is an optional, numeric argument that only applies
to supported image types.<br>
The values are width:height (width/height which is unitless) for example
for a 1:1 ratio (square) the value would be 1/1 = 1, for a 2:1 ratio
(wide rectangle) the value would be 2/1 = 2, for 4:3 ratio (landscape
photo) the value would be 4/3 = 1.33, etc. This value ensures an
exported reasonable shape for a plot regardless of the size or shape of
the application browser window.</li>
</ul>
<p><strong>Data Function Requirements</strong></p>
<ul>
<li>The function must require NO parameters. No parameters will be
provided when the function is called to retrieve the data.</li>
<li>The function must return an appropriate data format for the file
type. For instance, for csv/tsv/xlsx types the data returned should be
convertible to a tabular type.</li>
<li>Since the function is called at the time the user requests the data
it is acceptable and recommended to use reactive expressions providing
dynamic data to the user from the application.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inside server_local.R</span></span>
<span></span>
<span><span class="co">#single download type</span></span>
<span><span class="fu"><a href="../reference/downloadFile.html">downloadFile</a></span><span class="op">(</span><span class="st">"object_id1"</span>, </span>
<span>             logger       <span class="op">=</span> <span class="va">ss_userAction.Log</span>,</span>
<span>             filenameroot <span class="op">=</span> <span class="st">"mydownload1"</span>,</span>
<span>             datafxns     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>csv <span class="op">=</span> <span class="va">mydatafxn1</span><span class="op">)</span>,</span>
<span>             aspectratio  <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#multiple download types</span></span>
<span><span class="fu"><a href="../reference/downloadFile.html">downloadFile</a></span><span class="op">(</span><span class="st">"object_id2"</span>,</span>
<span>             logger       <span class="op">=</span> <span class="va">ss_userAction.Log</span>,</span>
<span>             filenameroot <span class="op">=</span> <span class="st">"mytype2"</span>,</span>
<span>             datafxns     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>csv <span class="op">=</span> <span class="va">mydatafxn1</span>, xlsx <span class="op">=</span> <span class="va">mydatafxn2</span><span class="op">)</span>,</span>
<span>             aspectratio  <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sample-application">Sample Application<a class="anchor" aria-label="anchor" href="#sample-application"></a>
</h3>
<p>For a complete running shiny example application using the
downloadableTable module you can create and run a <em>periscope2</em>
sample application using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Aggregate-Genius/periscope2" class="external-link">periscope2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">app_dir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/create_application.html">create_application</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'mysampleapp'</span>, location <span class="op">=</span> <span class="va">app_dir</span>, sample_app <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">app_dir</span>, <span class="st">'mysampleapp'</span>, sep <span class="op">=</span> <span class="va">.Platform</span><span class="op">$</span><span class="va">file.sep</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="additional-resources">Additional Resources<a class="anchor" aria-label="anchor" href="#additional-resources"></a>
</h2>
<p><strong>Vignettes</strong></p>
<ul>
<li><a href="new-application.html">New Application</a></li>
<li><a href="downloadableTable-module.html">downloadableTable
Module</a></li>
<li><a href="downloadablePlot-module.html">downloadablePlot
Module</a></li>
<li><a href="logViewer-module.html">logViewer Module</a></li>
<li><a href="applicationReset-module.html">applicationReset
Module</a></li>
<li><a href="announcement-module.html">announcement Module</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Mohammed Ali.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
