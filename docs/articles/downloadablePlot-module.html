<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the downloadablePlot Shiny Module • periscope2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the downloadablePlot Shiny Module">
<meta property="og:description" content="periscope2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">periscope2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/announcement-module.html">Using the Announcement Shiny Module</a>
    </li>
    <li>
      <a href="../articles/announcement_addin.html">Announcement Configuration YAML File Builder</a>
    </li>
    <li>
      <a href="../articles/applicationReset-module.html">Using the appReset Shiny Module</a>
    </li>
    <li>
      <a href="../articles/downloadFile-module.html">Using the downloadFile Shiny Module</a>
    </li>
    <li>
      <a href="../articles/downloadablePlot-module.html">Using the downloadablePlot Shiny Module</a>
    </li>
    <li>
      <a href="../articles/downloadableTable-module.html">Using the downloadableTable Shiny Module</a>
    </li>
    <li>
      <a href="../articles/logViewer-module.html">Using the logViewer Shiny Module</a>
    </li>
    <li>
      <a href="../articles/new-application.html">Creating a new framework-based application</a>
    </li>
    <li>
      <a href="../articles/themeBuilder_addin.html">Theme Configuration Builder</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Aggregate-Genius/periscope2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the downloadablePlot Shiny Module</h1>
                        <h4 data-toc-skip class="author">Dr. Connie
Brett</h4>
            
            <h4 data-toc-skip class="date">2023-12-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Aggregate-Genius/periscope2/blob/HEAD/vignettes/downloadablePlot-module.Rmd" class="external-link"><code>vignettes/downloadablePlot-module.Rmd</code></a></small>
      <div class="hidden name"><code>downloadablePlot-module.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<div class="section level3">
<h3 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h3>
<p>This <em>Shiny Module</em> provides an easy-to-use downloadFileButton
for a plot. It is that is automatically created, linked and managed.
This module is compatible with ggplot2, grob and lattice graphics – as
well as any superclass of these.</p>
</div>
<div class="section level3">
<h3 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h3>
<ul>
<li>Supports ggplot2, grob and lattice graphics (and superclasses) for
maximum flexibility</li>
<li>Uses the downloadFile Shiny Module functionality to ensure
consistent download functionality and paradigm for image or table
data</li>
<li>Ability to link different plot downloads from the displayed plot if
desired <em>(for example this might be used to ensure a
watermark/copyright notice on downloaded plots)</em>
</li>
<li>Ability to add data downloads in addition to image downloads using
the same button</li>
<li>Supports hover/click/brush functionality</li>
<li>Configurable plot size in application</li>
<li>Configurable plot aspect ratio for exported images</li>
<li>Configurable button placement at the bottom of the plot</li>
<li>Requires minimal code (see the Usage section for details)</li>
</ul>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="shiny-module-overview">Shiny Module Overview<a class="anchor" aria-label="anchor" href="#shiny-module-overview"></a>
</h3>
<p>Shiny modules consist of a pair of functions that modularize, or
package, a small piece of reusable functionality. The UI function is
called directly by the user to place the UI in the correct location (as
with other shiny UI objects). The module server function that is called
only once to set it up using the module name as a function inside the
server function (i.e. user-local session scope. The first function
argument is a string that represents the module id (the same id used in
module UI function). Additional arguments can be supplied by the user
based on the specific shiny module that is called. There can be
additional helper functions that are a part of a shiny module.</p>
<p>The <strong>downloadablePlot</strong> Shiny Module is a part of the
<em>periscope2</em> package and consists of the following functions:</p>
<ul>
<li>
<strong>downloadablePlotUI</strong> - the UI function to place the
plot in the application</li>
<li>
<strong>downloadablePlot</strong> - the server function to be called
inside server_local.R.</li>
</ul>
</div>
<div class="section level3">
<h3 id="downloadableplotui">downloadablePlotUI<a class="anchor" aria-label="anchor" href="#downloadableplotui"></a>
</h3>
<p>The <strong>downloadablePlotUI</strong> function is called from the
ui.R (or equivalent) file in the location where the plot should be
placed. This is similar to other UI element placement in shiny.</p>
<p>The downloadablePlotUI adds a button to the plot as seen in the
bottom right corner below:</p>
<center>
<img src="figures/downloadablePlot-1.png" width="500px">
</center>
<p>The downloadablePlotUI function takes the unique object ID for the UI
object.</p>
<p>The downloadtypes and download_hovertext arguments are passed to the
downloadFileButton and set the file types the button will allow the user
to request and the downloadFileButton’s tooltip text.</p>
<p>The width and height options set the plot size in the UI and can be
any css-recognizable size value.</p>
<p>These options are followed with alignment and overlap options for the
button placed on the chart.</p>
<p>The last three options give you the standard ways of interacting with
shiny plots - using the functionality available with the clickOpts,
hoverOpts and brushOpts functions.</p>
<p><strong>Note</strong>: When you create an object using any of these
functions shiny will send information about the user’s interactions with
the plot to the server and make it available to you via an input$
variable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inside ui_body.R or ui_sidebar.R</span></span>
<span></span>
<span><span class="fu"><a href="../reference/downloadablePlotUI.html">downloadablePlotUI</a></span><span class="op">(</span>id                 <span class="op">=</span> <span class="st">"object_id1"</span>, </span>
<span>                   downloadtypes      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"png"</span>, <span class="st">"csv"</span><span class="op">)</span>, </span>
<span>                   download_hovertext <span class="op">=</span> <span class="st">"Download the plot and data here!"</span>,</span>
<span>                   height             <span class="op">=</span> <span class="st">"500px"</span>, </span>
<span>                   btn_halign         <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downloadableplot">downloadablePlot<a class="anchor" aria-label="anchor" href="#downloadableplot"></a>
</h3>
<p>The <strong>downloadablePlot</strong> function is also called
directly. The call consists of the following:</p>
<ul>
<li>the unique object ID that was provided to downloadablePlotUI when
creating the UI object</li>
<li>the logging logger to be used</li>
<li>the root (prefix) of the downloaded file name to be used in the
browser as a character string or a reactive expression that returns a
character string</li>
<li>the aspect ratio as a numeric value for exported images of supported
types.
<ul>
<li>The values are width:height (width/height which is unitless) for
example for a 1:1 ratio (square) the value would be 1/1 = 1, for a 2:1
ratio (wide rectangle) the value would be 2/1 = 2, for 4:3 ratio
(landscape photo) the value would be 4/3 = 1.33, etc.<br>
</li>
<li>This value ensures an exported reasonable shape for a plot
regardless of the size or shape of the application browser window.</li>
</ul>
</li>
<li>a <strong>named list</strong> of functions or reactive expressions
that provide the images or data to the downloadFileButton (see below).
<ul>
<li>It is important that the types of files to be downloaded are matched
to the correct named function in the list.<br>
</li>
<li>The function/reactive names are unquoted - they will be called at
the time the user initiates a download <em>(see requirements
below)</em>.</li>
</ul>
</li>
<li>a function or reactive expression providing the plot output for the
visible plot. It can be the same, or different from the ones provided to
any of the download functions. This allows finer control over what the
user can view vs. download if desired. For example you can allow a user
to view a smaller subset of data but download an expanded dataset, or
perhaps download a redacted version of data, etc.</li>
</ul>
<p>** Plot/Download Function or Reactive Expression Requirements**</p>
<ul>
<li>If a function is provided it must be parameter-less (require NO
parameters). No parameters will be provided when a function is called to
retrieve the plot or data. Reactive expressions cannot take parameters
by definition.</li>
<li>The function or reactive expression must return an appropriate data
format for the file type. For instance: csv/tsv/xlsx types require data
that is convertible to a tabular type, tiff formats require a tiff class
object, etc. For more information on conversion of data to various
download types see the downloadFile module help or vignette.</li>
<li>For the visible plot the return value must be from the ggplot2, grob
or lattice classes (or a superclass therein)</li>
<li>Since the function or reactive expression is called at the time the
user requests the data it is recommended that reactive expressions are
used to provide dynamic values from the application to create the
plot.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inside server_local.R</span></span>
<span></span>
<span><span class="fu"><a href="../reference/downloadablePlot.html">downloadablePlot</a></span><span class="op">(</span>id           <span class="op">=</span> <span class="st">"object_id1"</span>,</span>
<span>                 logger       <span class="op">=</span> <span class="va">ss_userAction.Log</span>,</span>
<span>                 filenameroot <span class="op">=</span> <span class="st">"mydownload1"</span>,</span>
<span>                 aspectratio  <span class="op">=</span> <span class="fl">1.33</span>,</span>
<span>                 downloadfxns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>png <span class="op">=</span> <span class="va">myplotfxn</span>,</span>
<span>                                     tsv <span class="op">=</span> <span class="va">mydatafxn</span><span class="op">)</span>,</span>
<span>                 visibleplot  <span class="op">=</span> <span class="va">myplotfxn</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="additional-resources">Additional Resources<a class="anchor" aria-label="anchor" href="#additional-resources"></a>
</h2>
<p><strong>Vignettes</strong></p>
<ul>
<li><a href="new-application.html">New Application</a></li>
<li><a href="downloadFile-module.html">downloadFile Module</a></li>
<li><a href="downloadableTable-module.html">downloadableTable
Module</a></li>
<li><a href="logViewer-module.html">logViewer Module</a></li>
<li><a href="applicationReset-module.html">applicationReset
Module</a></li>
<li><a href="announcement-module.html">announcement Module</a></li>
<li><a href="announcement_addin.html">Announcement Configuration
Builder</a></li>
<li><a href="themeBuilder_addin.html">Theme Configuration
Builder</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Mohammed Ali.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
